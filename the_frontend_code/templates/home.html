<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>食物与健康</title>

  <!-- Google fonts -->
  <link href="//fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;500&display=swap" rel="stylesheet">
  <link href="//fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&display=swap" rel="stylesheet">

  <!-- Template CSS -->
  <link rel="stylesheet" href="assets/css/style-starter.css">
  <!-- 登录css -->
  <link rel="stylesheet" href="../static/css/style.css" type="text/css" media="all">
</head>

<body>
  <!--header-->
  <header id="site-header" class="fixed-top">
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-light stroke">
        <a class="navbar-brand" href="index.html">
          <span> 食物</span>
          <span> 与健康</span>
        </a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarNav"
          aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="fa icon-expand fa-bars"></span>
          <span class="fa icon-close fa-times"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item active">
              <a class="nav-link" href="home.html">Home </a>
            </li>
            <li class="nav-item @@active">
              <a class="nav-link" href="foodinfoList.html">食物说</a>
            </li>
            <li class="nav-item @@active">
              <a class="nav-link" href="DietAndNutrition.html">食谱与营养</a>
            </li>
          </ul>
        </div>

        <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
          <div class="popup ml-auto">
            <a href="#menu" class="domain" data-toggle="modal" data-target="#DomainModal">
              <div class="hamburger">
                <svg t="1650099328672" class="icon" viewBox="0 0 1024 1024" version="1.1"
                  xmlns="http://www.w3.org/2000/svg" p-id="2567" width="200" height="200">
                  <path
                    d="M500 128.8c-95.2 5.6-173.6 83.2-180 178.4-7.2 112 80.8 205.6 191.2 205.6 106.4 0 192-86.4 192-192 0.8-110.4-92-198.4-203.2-192zM512 575.2c-128 0-383.2 64-383.2 192v96c0 17.6 14.4 32 32 32h702.4c17.6 0 32-14.4 32-32V766.4c0-127.2-255.2-191.2-383.2-191.2z"
                    p-id="2568"></path>
                </svg>
              </div>
            </a>
          </div>
        </div>

        <!-- toggle switch for light and dark theme -->
        <div class="mobile-position ml-lg-2">
          <nav class="navigation">
            <div class="theme-switch-wrapper">
              <label class="theme-switch" for="checkbox">
                <input type="checkbox" id="checkbox">
                <div class="mode-container">
                  <i class="gg-sun"></i>
                  <i class="gg-moon"></i>
                </div>
              </label>
            </div>
          </nav>
        </div>
        <!-- //toggle switch for light and dark theme -->
      </nav>
    </div>
  </header>
  <!--/header-->
  <div class="header-gap">
  </div>
  <!-- 侧登录模块 -->
  <div class="modal right fade" id="DomainModal" tabindex="-1" role="dialog" aria-labelledby="DomainModalLabel2">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
            aria-hidden="true">&times;</span></button>
        <div class="modal-body">
          <div class="modal__content">
            <a class="navbar-brand"> <span>登录 </span></a>
            <div class="widget-social-icons mt-sm-5 mt-4">
              <ul class="icon-rounded address">
                <div class="wthree-field">
                  <input name="userName" id="userName" type="text" value="" placeholder="Username" required>
                </div>
                <div class="wthree-field">
                  <input name="pwd" id="pwd" type="Password" placeholder="Password" required>
                </div>
                <div class="wthree-field">
                  <button type="button" id="wangsubmit" name="submit" class="btn">登录</button>
                </div>
                <div class="wthree-field">
                  <a href="#menu" class="domain" data-toggle="modal" data-target="#DomainModal2">注册</a>
                </div>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 侧注册模块 -->
  <div class="modal right fade" id="DomainModal2" tabindex="-1" role="dialog" aria-labelledby="DomainModalLabel2">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
            aria-hidden="true">&times;</span></button>

        <div class="modal-body">
          <div class="modal__content">
            <a class="navbar-brand"> <span>注册 </span></a>
            <div class="widget-social-icons mt-sm-5 mt-4">
              <ul class="icon-rounded address">
                <div class="wthree-field">
                  <input name="userName" id="userNameRegister" type="text" value="" placeholder="Username" required>
                </div>
                <div class="wthree-field">
                  <input name="pwd" id="pwdRegister" type="Password" placeholder="Password">
                </div>
                <div class="wthree-field">
                  <input name="tel" id="telRegister" type="text" placeholder="Telephone">
                </div>
                <div class="wthree-field">
                  <button type="button" name="submit" id="submitRegister" class="btn">注册</button>
                </div>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- //Domain modal -->
  <!-- home page about section -->
  <section class="w3l-homeblock1" id="about">
    <div class="midd-w3 py-5">
      <div class="container py-lg-5 py-md-3">
        <div class="row">
          <div class="col-lg-6">
            <span class="text">食物与健康</span>
            <div class="col-lg-6 mt-lg-0 mt-5">
              <div class="position-relative">
                <img src="assets/images/about.jpg" alt="" class="radius-image img-fluid">
              </div>
            </div>
          </div>
        </div>
      </div>
  </section>
  <!-- //home page about section -->

  <div class="copyright py-sm-5 py-4 text-center">
    <div class="container">
    </div>
  </div>
  <!-- move top -->
  <button onclick="topFunction()" id="movetop" title="Go to top">
    <span class="fa fa-angle-up"></span>
  </button>
  <script>
    // When the user scrolls down 20px from the top of the document, show the button
    window.onscroll = function () {
      scrollFunction()
    };

    function scrollFunction() {
      if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
        document.getElementById("movetop").style.display = "block";
      } else {
        document.getElementById("movetop").style.display = "none";
      }
    }

    // When the user clicks on the button, scroll to the top of the document
    function topFunction() {
      document.body.scrollTop = 0;
      document.documentElement.scrollTop = 0;
    }
  </script>
  <!-- /move top -->

  <!-- jQuery and Bootstrap JS -->
  <script src="assets/js/jquery-3.3.1.min.js"></script>

  <script src="assets/js/theme-change.js"></script><!-- theme switch js (light and dark)-->

  <script src="../static/js/jquery/jquery-3.3.1.min.js"></script>

  <!-- 登录 -->
  <script>
    function func() {
      //验证用户是否已经注册过
      var userName = $("#userName").val();//获取表单元素值
      var pwd = $("#pwd").val();
      // var userName = document.getElementById('userName').value;
      if (userName == "") {
        alert("昵称不能为空！");
        return false;
      }
      if (pwd == "") {
        alert("密码不能为空！");
        return false;
      }
      if (pwd.length < 4) {
        alert("密码不能少于4位！");
        return false;
      }
      return true;
    }

    $("#wangsubmit").on("click", function () {
      console.log("ssssssss")
      if (!func()) {
        console.log("!!!!!!");
        return false;
      }
      var userName = $("#userName").val();//获取表单元素值
      var pwd = $("#pwd").val();
      var data = {
        userName: userName,
        pwd: pwd
      };
      console.log(userName)
      console.log(data)
      $.ajax({
        type: "POST",
        //待载入页面的url
        url: "http://localhost:8080/login",
        data: data,
        dataType: 'json',
        success: function (msg) {
          console.log("进success了");
          console.log(msg)
          if ("200" == msg.code) {
            localStorage.setItem("user", JSON.stringify(msg.data))
            console.log("success" + msg);
            alert("handsome")
            window.location.href = "userHome.html";
          } else if ("11" == msg.data) {
            alert("该用户不存在！");
            console.log("该用户不存在！");
            return false;
          } else if ("22" == msg.data) {
            alert("密码输入错误，错误输入三次后您的账户将会被锁定！");
            return false;
          } else if ("33" == msg.data) {
            alert("您由于错误登陆次数太多，系统已将您的账户锁定，请在三分钟后重新登录！");
            return false;
          }
        },
        error: function (XMLHttpRequest, textStatus, errorThrown) {
          console.log("进error了")
          // 状态码
          console.log(XMLHttpRequest.status);
          // 状态
          console.log(XMLHttpRequest.readyState);
          // 错误信息
          console.log(textStatus);
        }
      });
    });
  </script>
  <!-- /登录 -->

  <!-- 注册 -->
  <script>
    function rfunc() {
      console.log("现在在rfunc方法中")
      var userName = $("#userNameRegister").val();
      // let user = document.getElementById("userName").value;
      var pwd = $("#pwdRegister").val();
      var tel = $("#telRegister").val();
      if (userName == "") {
        alert("用户名不能为空！");
        return false;
      }
      if (pwd == "") {
        alert("密码不能为空！");
        return false;
      }
      if (tel == "") {
        alert("手机号不能为空！");
        return false;
      }
      // if (!(/^1[34578]\d{9}$/.test(pwd))) {
      //     alert("手机号输入错误");
      //     return false;
      // }
      if (pwd.length < 4) {
        alert("密码不能少于4位！");
        return false;
      }
      return true;
    }

    $("#submitRegister").on("click", function () {
      if (!rfunc()) {
        console.log("!!!!!!");
        return false;
      }
      var userName = $("#userNameRegister").val();//获取表单元素值
      var pwd = $("#pwdRegister").val();
      var tel = $("#telRegister").val();
      var data = {
        userName: userName,
        pwd: pwd,
        tel: tel
      };
      console.log(data);
      $.ajax({
        type: "POST",
        //待载入页面的url,方法名
        url: "http://localhost:8080/register",
        data: data,    //后台传回的数据
        dataType: 'json',
        success: function (msg) {
          if ("00" == msg.errorCode) {
            console.log("success");
            alert("注册成功！！！")
            window.location.href = "userHome.html";
          } else if ("11" == msg.errorCode) {
            alert("该用户已经存在！");
            console.log("该用户已经存在！");
            return false;
          } else if ("22" == msg.errorCode) {
            alert("该手机号已经注册！");
            console.log("该手机号已经注册！");
            return false;
          }
        }
      })
    })
  </script>
  <!-- /注册 -->

  <!-- owlcarousel -->
  <script src="assets/js/owl.carousel.js"></script>

  <!-- MENU-JS -->
  <script>
    $(window).on("scroll", function () {
      var scroll = $(window).scrollTop();

      if (scroll >= 80) {
        $("#site-header").addClass("nav-fixed");
      } else {
        $("#site-header").removeClass("nav-fixed");
      }
    });

    //Main navigation Active Class Add Remove
    $(".navbar-toggler").on("click", function () {
      $("header").toggleClass("active");
    });
    $(document).on("ready", function () {
      if ($(window).width() > 991) {
        $("header").removeClass("active");
      }
      $(window).on("resize", function () {
        if ($(window).width() > 991) {
          $("header").removeClass("active");
        }
      });
    });
  </script>
  <!-- //MENU-JS -->

  <!-- bootstrap侧模块展示 -->
  <script src="assets/js/bootstrap.min.js"></script>

</body>

</html>